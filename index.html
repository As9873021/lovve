<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æˆ‘å€‘çš„ LINE æƒ…ä¾¶ç…§ç‰‡ç‰†</title>

  <!-- LIFF v2 SDK å®˜æ–¹ CDN [web:45] -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #ffe5ec, #fff0f5);
      min-height: 100vh;
      padding: 16px;
      display: flex;
      justify-content: center;
    }
    .app {
      width: 100%;
      max-width: 900px;
      background: rgba(255,255,255,0.95);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 12px 30px rgba(0,0,0,0.08);
    }
    .header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }
    .avatar {
      width: 42px;
      height: 42px;
      border-radius: 999px;
      background: #ffd1e3;
      overflow: hidden;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: #fff;
    }
    .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .header-text h1 {
      font-size: 20px;
      margin-bottom: 2px;
    }
    .header-text p {
      font-size: 12px;
      color: #666;
    }
    .status {
      font-size: 11px;
      color: #888;
      margin-bottom: 8px;
    }

    .upload-box {
      border: 2px dashed #ff9eb5;
      border-radius: 12px;
      padding: 14px;
      text-align: center;
      background: #fff7fb;
      margin-bottom: 14px;
    }
    .upload-box input[type="file"] {
      display: none;
    }
    .upload-label {
      display: inline-block;
      padding: 8px 16px;
      border-radius: 999px;
      background: linear-gradient(135deg, #ff7aa2, #ff9eb5);
      color: #fff;
      font-size: 13px;
      cursor: pointer;
      margin-bottom: 4px;
    }
    .upload-box small {
      display: block;
      font-size: 11px;
      color: #666;
    }

    .preview {
      display: none;
      margin-top: 12px;
      text-align: left;
    }
    .preview img {
      max-width: 180px;
      border-radius: 12px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.1);
      display: block;
      margin-bottom: 6px;
    }
    .preview textarea {
      width: 100%;
      min-height: 52px;
      border-radius: 10px;
      border: 1px solid #ffbfd1;
      padding: 6px;
      font-size: 12px;
      resize: vertical;
      outline: none;
    }
    .preview textarea:focus {
      border-color: #ff7aa2;
      box-shadow: 0 0 0 2px rgba(255,122,162,0.2);
    }
    .preview button {
      margin-top: 6px;
      padding: 6px 14px;
      border-radius: 999px;
      border: none;
      background: #ff7aa2;
      color: #fff;
      font-size: 12px;
      cursor: pointer;
    }
    .preview button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 12px;
    }
    .card {
      background: #fff;
      border-radius: 14px;
      padding: 8px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .card img {
      width: 100%;
      border-radius: 10px;
      object-fit: cover;
      max-height: 180px;
    }
    .card-text {
      font-size: 12px;
      color: #444;
      white-space: pre-wrap;
    }
    .card-meta {
      font-size: 10px;
      color: #999;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .tag {
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 10px;
      background: #ffe5ec;
      color: #c2527b;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <div class="avatar" id="avatar">ğŸ’•</div>
      <div class="header-text">
        <h1>æˆ‘å€‘çš„ç…§ç‰‡ç‰†</h1>
        <p id="subtitle">æ­£åœ¨å¾ LINE å–å¾—ä½ çš„è³‡æ–™...</p>
      </div>
    </div>

    <div class="status" id="status"></div>

    <div class="upload-box">
      <label class="upload-label" for="file-input">ï¼‹ æ–°å¢ç…§ç‰‡</label>
      <input id="file-input" type="file" accept="image/*" />
      <small>è«‹å¾ LINE App è£¡é–‹å•Ÿï¼Œæ”¯æ´æ‰‹æ©Ÿæ‹ç…§æˆ–å¾ç›¸ç°¿é¸æ“‡åœ–ç‰‡ã€‚</small>

      <div class="preview" id="preview">
        <img id="preview-img" alt="é è¦½åœ–ç‰‡" />
        <textarea id="preview-text" placeholder="æƒ³å¯«ä¸€å¥è©±çµ¦å°æ–¹å—ï¼Ÿï¼ˆå¯ç©ºç™½ï¼‰"></textarea>
        <button id="add-btn" disabled>åŠ å…¥ç…§ç‰‡ç‰†</button>
      </div>
    </div>

    <div class="grid" id="photo-grid"></div>
  </div>

  <script>
    // æŠŠé€™è£¡æ›æˆä½ å¾Œå°çœ‹åˆ°çš„ LIFF ID [web:45][web:90]
    const LIFF_ID = '2008662868-yAm8omQe';

    const avatarDiv = document.getElementById('avatar');
    const subtitleEl = document.getElementById('subtitle');
    const statusEl = document.getElementById('status');
    const fileInput = document.getElementById('file-input');
    const preview = document.getElementById('preview');
    const previewImg = document.getElementById('preview-img');
    const previewText = document.getElementById('preview-text');
    const addBtn = document.getElementById('add-btn');
    const photoGrid = document.getElementById('photo-grid');

    let currentImageUrl = null;
    let currentUser = null;

    async function initLiff() {
      try {
        statusEl.textContent = 'åˆå§‹åŒ– LIFF ä¸­...';

        await liff.init({ liffId: LIFF_ID }); // å®˜æ–¹æ–‡ä»¶å»ºè­°çš„åˆå§‹åŒ–æ–¹å¼ã€‚[web:45][web:90]

        if (!liff.isLoggedIn()) {
          statusEl.textContent = 'å°šæœªç™»å…¥ LINEï¼Œå°å‘ç™»å…¥é é¢...';
          liff.login();
          return;
        }

        const profile = await liff.getProfile(); // å–å¾— userIdã€displayNameã€pictureUrlã€‚[web:27][web:95]
        currentUser = profile;

        subtitleEl.textContent = `å—¨ï¼Œ${profile.displayName}ï¼Œä¸€èµ·è¨˜éŒ„ä½ å€‘çš„å›æ†¶å§ ğŸ’•`;
        statusEl.textContent = 'å·²å¾ LINE å–å¾—ä½ çš„èº«ä»½è³‡è¨Šã€‚';

        if (profile.pictureUrl) {
          avatarDiv.innerHTML = '';
          const img = document.createElement('img');
          img.src = profile.pictureUrl;
          avatarDiv.appendChild(img);
        }

      } catch (err) {
        console.error(err);
        statusEl.textContent = 'LIFF åˆå§‹åŒ–å¤±æ•—ï¼Œè«‹ç¢ºèª LIFF ID èˆ‡å¾Œå°è¨­å®šæ˜¯å¦æ­£ç¢ºã€‚';
      }
    }

    // æœ¬åœ°åœ–ç‰‡é è¦½ï¼ˆä¸ä¸Šå‚³ä¼ºæœå™¨ï¼‰[web:101][web:20]
    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const url = URL.createObjectURL(file);
      currentImageUrl = url;
      previewImg.src = url;
      preview.style.display = 'block';
      addBtn.disabled = false;
    });

    addBtn.addEventListener('click', () => {
      if (!currentImageUrl) return;

      const text = previewText.value.trim();
      const card = document.createElement('div');
      card.className = 'card';

      const img = document.createElement('img');
      img.src = currentImageUrl;

      const textDiv = document.createElement('div');
      textDiv.className = 'card-text';
      textDiv.textContent = text || 'ï¼ˆä»€éº¼éƒ½æ²’å¯«ï¼Œä½†é‚„æ˜¯å¾ˆç”œã€‚ï¼‰';

      const meta = document.createElement('div');
      meta.className = 'card-meta';

      const dateSpan = document.createElement('span');
      const now = new Date();
      dateSpan.textContent = now.toLocaleString();

      const tag = document.createElement('span');
      tag.className = 'tag';
      tag.textContent = currentUser
        ? `${currentUser.displayName} çš„å›æ†¶`
        : 'æˆ‘å€‘çš„å›æ†¶';

      meta.appendChild(dateSpan);
      meta.appendChild(tag);

      card.appendChild(img);
      card.appendChild(textDiv);
      card.appendChild(meta);

      photoGrid.prepend(card);

      // æ¸…ç©ºé è¦½
      previewText.value = '';
      preview.style.display = 'none';
      addBtn.disabled = true;
      currentImageUrl = null;
      fileInput.value = '';
    });

    document.addEventListener('DOMContentLoaded', initLiff);
  </script>
</body>
</html>
